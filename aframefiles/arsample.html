<script src="https://aframe.io/releases/0.8.0/aframe.min.js"></script>
<script src="https://rawgit.com/donmccurdy/aframe-extras/master/dist/aframe-extras.loaders.min.js"></script>
<!-- include ar.js for A-Frame -->
<script src="aframeAR.js"></script>

<body style='margin : 0px; overflow: hidden;'>
    <!-- <a-scene embedded arjs>
        <a-assets>
            <a-asset-item id="tree" src="scene.gltf" crossOrigin="anonymous"></a-asset-item>
            <img id="table" src="table.png" />
        </a-assets> -->
    

    <!-- <a-entity gltf-model="#tree" height="0.5" width="0.5" position="0 1 -1"></a-entity> -->

    <!-- <a-curvedimage src="#table" id="laptop" radius="5.7" theta-length="60" height="2.6" scale-on-mouseenter="to: 5 5 5" rotation="0 0 0"
            scale="1.2 1.2 1.2" material="" geometry="">
        </a-curvedimage> -->
    <!-- create your content here. just a box for now -->
    <!-- <a-box color="tomato" depth="2" height="4" width="0.5"></a-box> -->
    <!-- define a camera which will move according to the marker position -->
    <!-- <a-marker-camera preset='hiro'></a-marker-camera> -->
    <!-- </a-scene> -->
    <a-scene embedded artoolkit='sourceType: webcam;'>
<!--          3d model -->
        <a-assets>
                  <a-asset-item id="tree" src="scene.gltf" crossOrigin="anonymous"></a-asset-item>
        </a-assets>
<!--          end -->
        <a-gltf-model src="#tree"></a-gltf-model>
        <a-marker-camera preset='hiro'></a-marker-camera>
        
<!--         <a-entity gltf-model="#brainstem" position="0 0 -5" scale="3 3 3"></a-entity> -->
        
<!--         <a-box color="tomato" depth="2" height="4" width="0.5"></a-box> -->
<!--         <a-marker-camera preset='hiro'> -->
<!--         <a-entity gltf-model-next="src: url(https://cdn.aframe.io/test-models/models/brainstem/BrainStem.gltf);"> -->
<!--         </a-entity> -->
        
        
        </a-marker-camera>
    </a-scene>

<script>
        AFRAME.registerComponent('autoscale', {
            schema: {
                type: 'number',
                default: 1
            },
            init: function () {
                this.scale();
                this.el.addEventListener('object3dset', () => this.scale());
            },
            scale: function () {
                debugger;
                const el = this.el;
                const span = this.data;
                const mesh = el.getObject3D('mesh');

                if (!mesh) return;

                // Compute bounds.
                const bbox = new THREE.Box3().setFromObject(mesh);

                // Normalize scale.
                const scale = span / bbox.getSize().length();
                mesh.scale.set(scale, scale, scale);

                // Recenter.
                const offset = bbox.getCenter().multiplyScalar(scale);
                mesh.position.sub(offset);
            }
        });
    </script>

</body>
